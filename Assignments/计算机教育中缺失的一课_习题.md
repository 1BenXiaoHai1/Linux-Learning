# 计算机教育中缺失的一课_习题

## Lecture1 shell的基本概念

1. 本课程需要使用类Unix shell，例如 Bash 或 ZSH。如果您在 Linux 或者 MacOS 上面完成本课程的练习，则不需要做任何特殊的操作。如果您使用的是 Windows，则您不应该使用 cmd 或是 Powershell；您可以使用[Windows Subsystem for Linux](https://docs.microsoft.com/en-us/windows/wsl/)或者是 Linux 虚拟机。使用`echo $SHELL`命令可以查看您的 shell 是否满足要求。如果打印结果为`/bin/bash`或`/usr/bin/zsh`则是可以的。

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103220759302.png" alt="image-20240103220759302" style="zoom: 67%;" />

2. 在 `/桌面/codeExercise/Linux` 下新建一个名为 `missing` 的文件夹。

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103221127305.png" alt="image-20240103221127305" style="zoom: 50%;" />

3. 用 `man` 查看程序 `touch` 的使用手册。顺便使用tldr查看一下。

   ![image-20240103221238623](/home/benxiaohai/.config/Typora/typora-user-images/image-20240103221238623.png)

   ![image-20240103221459736](/home/benxiaohai/.config/Typora/typora-user-images/image-20240103221459736.png)

4. 用 `touch` 在 `missing` 文件夹中新建一个叫 `semester` 的文件。

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103221547909.png" alt="image-20240103221547909" style="zoom: 50%;" />

5. 将以下内容一行一行地写入

   ```plaintext
   semester
   ```

   文件：

   ```
    #!/bin/sh
    curl --head --silent https://missing.csail.mit.edu
   ```

   第一行可能有点棘手， `#` 在Bash中表示注释，而 `!` 即使被双引号（`"`）包裹也具有特殊的含义。 单引号（`'`）则不一样，此处利用这一点解决输入问题。更多信息请参考 [Bash quoting 手册](https://www.gnu.org/software/bash/manual/html_node/Quoting.html)

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103221854815.png" alt="image-20240103221854815" style="zoom: 45%;" />

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103223537391.png" alt="image-20240103223537391" style="zoom: 45%;" />

6. 尝试执行这个文件。例如，将该脚本的路径（`./semester`）输入到您的shell中并回车。如果程序无法执行，请使用 `ls` 命令来获取信息并理解其不能执行的原因。

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103222116694.png" alt="image-20240103222116694" style="zoom: 50%;" />

7. 查看 `chmod` 的手册(例如，使用 `man chmod` 命令)

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103222242429.png" alt="image-20240103222242429" style="zoom:40%;" />

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103222401973.png" alt="image-20240103222401973" style="zoom:45%;" />

8. 使用 `chmod` 命令改变权限，使 `./semester` 能够成功执行，不要使用 `sh semester` 来执行该程序。您的 shell 是如何知晓这个文件需要使用 `sh` 来解析呢？更多信息请参考：[shebang](https://en.wikipedia.org/wiki/Shebang_(Unix))

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103222907688.png" alt="image-20240103222907688" style="zoom: 50%;" />

9. 使用 `|` 和 `>` ，将 `semester` 文件输出的最后更改日期信息，写入主目录下的 `last-modified.txt` 的文件中

   ```shell
   ./semester | grep "last-modified:" > modified.txt 
   # |管道连接执行脚本命令和grep命令。然后再输出重定向到modified.txt文件中
   ```

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103223222628.png" alt="image-20240103223222628" style="zoom:50%;" />

10. 写一段命令来从 `/sys` 中获取笔记本的电量信息，或者台式机 CPU 的温度。注意：macOS 并没有 sysfs，所以 Mac 用户可以跳过这一题。

    <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103223840375.png" alt="image-20240103223840375" style="zoom:50%;" />

## Lecture2 shell工具和脚本

1. 阅读 [`man ls`](https://man7.org/linux/man-pages/man1/ls.1.html) ，然后使用`ls` 命令进行如下操作：

   - 所有文件（包括隐藏文件）
   - 文件打印以人类可以理解的格式输出 (例如，使用454M 而不是 454279954)
   - 文件以最近访问顺序排序
   - 以彩色文本显示输出结果

   典型输出如下：

   ```shell
    -rw-r--r--   1 user group 1.1M Jan 14 09:53 baz
    drwxr-xr-x   5 user group  160 Jan 14 09:53 .
    -rw-r--r--   1 user group  514 Jan 14 06:42 bar
    -rw-r--r--   1 user group 106M Jan 13 12:12 foo
    drwx------+ 47 user group 1.5K Jan 12 18:08 ..
   ```

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103224803655.png" alt="image-20240103224803655" style="zoom: 50%;" />

   <img src="/home/benxiaohai/.config/Typora/typora-user-images/image-20240103224943369.png" alt="image-20240103224943369" style="zoom: 50%;" />

2. 编写两个bash函数 `marco` 和 `polo` 执行下面的操作。 每当你执行 `marco` 时，当前的工作目录应当以某种形式保存，当执行 `polo` 时，无论现在处在什么目录下，都应当 `cd` 回到当时执行 `marco` 的目录。 为了方便debug，你可以把代码写在单独的文件 `marco.sh` 中，并通过 `source marco.sh`命令，（重新）加载函数。

   

3. 假设您有一个命令，它很少出错。因此为了在出错时能够对其进行调试，需要花费大量的时间重现错误并捕获输出。 编写一段bash脚本，运行如下的脚本直到它出错，将它的标准输出和标准错误流记录到文件，并在最后输出所有内容。 加分项：报告脚本在失败前共运行了多少次。

   ```shell
    #!/usr/bin/env bash
   
    n=$(( RANDOM % 100 ))
   
    if [[ n -eq 42 ]]; then
       echo "Something went wrong"
       >&2 echo "The error was using magic numbers"
       exit 1
    fi
   
    echo "Everything went according to plan"
   ```

4. 本节课我们讲解的 `find` 命令中的 `-exec` 参数非常强大，它可以对我们查找的文件进行操作。但是，如果我们要对所有文件进行操作呢？例如创建一个zip压缩文件？我们已经知道，命令行可以从参数或标准输入接受输入。在用管道连接命令时，我们将标准输出和标准输入连接起来，但是有些命令，例如`tar` 则需要从参数接受输入。这里我们可以使用[`xargs`](https://man7.org/linux/man-pages/man1/xargs.1.html) 命令，它可以使用标准输入中的内容作为参数。 例如 `ls | xargs rm` 会删除当前目录中的所有文件。

   您的任务是编写一个命令，它可以递归地查找文件夹中所有的HTML文件，并将它们压缩成zip文件。注意，即使文件名中包含空格，您的命令也应该能够正确执行（提示：查看 `xargs`的参数`-d`，译注：MacOS 上的 `xargs`没有`-d`，[查看这个issue](https://github.com/missing-semester/missing-semester/issues/93)）

   如果您使用的是 MacOS，请注意默认的 BSD `find` 与 [GNU coreutils](https://en.wikipedia.org/wiki/List_of_GNU_Core_Utilities_commands) 中的是不一样的。你可以为`find`添加`-print0`选项，并为`xargs`添加`-0`选项。作为 Mac 用户，您需要注意 mac 系统自带的命令行工具和 GNU 中对应的工具是有区别的；如果你想使用 GNU 版本的工具，也可以使用 [brew 来安装](https://formulae.brew.sh/formula/coreutils)。

5. （进阶）编写一个命令或脚本递归的查找文件夹中最近使用的文件。更通用的做法，你可以按照最近的使用时间列出文件吗？

## Lecture3 编辑器Vim



## Lecture4 数据清洗